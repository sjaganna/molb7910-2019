count_summary_rna <- read_delim("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/2018_MOLB7910/1-class1/data/count_summary_rna.tsv",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
library("tidyverse")
count_summary_rna <- read_delim("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/2018_MOLB7910/1-class1/data/count_summary_rna.tsv",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
names(count_summary_rna)
library(readr)
experiment_metadata <- read_delim("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/experiment-metadata.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(experiment_metadata)
head(count_summary_rna)
tail(count_summary_rna)
summary(count_summary_rna)
summary(count_summary_rna$Geneid)
summary(count_summary_rna$`0h_1_RNA_S13_umi.bam`)
glimpse(count_summary_rna)
str(count_summary_rna)
table(count_summary_rna$`0h_1_RNA_S13_umi.bam`)
table(count_summary_rna$Chr)
table(count_summary_rna$Length)
table(experiment_metadata$hour)
glimpse(experiment_metadata)
pwd
getwd()
2 + 3 * 5
here()
library(here)
setwd("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/code")
setwd("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/code")
class(x)
x <- c(1,3,2,10,5)
class(s)
class(x)
x <- c(TRUE, FALSE, TRUE)
class(x)
chr <- c("chr1", "chr1", "chr2", "chr2")
strand <- c("-", "-", "+", "+")
start <- c(200,4000,100,400)
end <-c(250,410,200,450)
mydata <- data.frame(chr, start, end, strand)
names(mydata)
#change column names
names(mydata) <- c("A", "B", "C", "D")
mydata
# here you can assign names  (in caps in this example) to each list that will be combined to make a dataframe. These list names will be transferred to the column name.
mydata <- data.frame(CHROM=chr,
START=start,
STOP=end,
STRAND=strand)
class(mydata)
class(mydata)m2 <- matrix(c(1,3,2,5,-1,2,2,3,9),nrow=3)
m2 <- matrix(c(1,3,2,5,-1,2,2,3,9),nrow=3)
class(m2)
is.data.frame(m2)
is.matrix(m2)
is.tibble(iris)
data(iris)
is.tibble(iris)
x <- c(1, 2, 3, 4, 5)
typeof(x)
class(x)
iris <- data("iris")
str(iris)
iris
setwd("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/code")
here()
here()
here()
rmarkdown::render_site()
rmarkdown::render_site()
names(count_summary_rna)
count_summary_rna <- read_delim(here("1-class1",
"data",
"count_summary_rna.tsv"),
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
library(dplyr)
count_summary_rna <- read_delim(here("1-class1",
"data",
"count_summary_rna.tsv"),
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
library("tidyverse")
count_summary_rna <- read_delim(here("1-class1",
"data",
"count_summary_rna.tsv"),
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
count_summary_rna <- read_delim("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/count_summary_rna.tsv",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
names(count_summary_rna)
x <- count_summary_rna %>% rename(hour1_rep1 = `0h_1_RNA_S13_umi.bam`)
View(x)
names(x)
count_summary_rna <- count_summary_rna %>%
rename(
hour00_rep1 = `0h_1_RNA_S13_umi.bam`,
hour00_rep2 = `0h_2_RNA_S14_umi.bam`,
hour00_rep3 = `0h_3_RNA_S15_umi.bam`,
hour04_rep1 = `4h_1_RNA_S16_umi.bam`,
hour04_rep2 = `4h_2_RNA_S17_umi.bam`,
hour04_rep3 = `4h_3_RNA_S18_umi.bam`,
hour08_rep1 = `8h_1_RNA_S19_umi.bam`,
hour08_rep2 = `8h_2_RNA_S20_umi.bam`,
hour08_rep3 = `8h_3_RNA_S21_umi.bam`,
hour14_rep1 = `14h_1_RNA_S22_umi.bam`,
hour14_rep2 = `14h_2_RNA_S23_umi.bam`,
hour14_rep3 = `14h_3_RNA_S24_umi.bam`)
View(count_summary_rna)
setwd("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/code")
rmarkdown::render_site()
rmarkdown::render_site()
install.packages("install.packages("rmarkdown")")
install.packages("rmarkdown")
install.packages("rmarkdown")
install.packages("rmarkdown")
install.packages("rmarkdown")
library("rmarkdown")
q()
View(count_summary_rna)
View(data)
View(count_summary_rna)
names(count_summary_rna)
data <- count_summary_rna %>%
select(-Chr, -Start, -End, -Strand)
library("tidyverse")
data <- count_summary_rna %>%
select(-Chr, -Start, -End, -Strand)
View(data)
data <- data %>% arrange(hour14_rep1)
View(data)
data <- data %>% arrange(desc(hour14_rep1))
View(data)
View(data)
hist(data$hour14_rep1)
hist(log2(data$hour14_rep1))
2^10
plot(count_summary_rna$hour00_rep1)
plot(log2(count_summary_rna$hour00_rep1))
log2(1)
log2(2)
log2(0.1)
plot(count_summary_rna$hour00_rep1, count_summary_rna$hour00_rep2)
plot(count_summary_rna$hour00_rep1, count_summary_rna$hour04_rep1)
plot(count_summary_rna$hour00_rep1, count_summary_rna$hour14_rep1)
plot(log2(count_summary_rna$hour00_rep1), log2(count_summary_rna$hour14_rep1))
plot(log2(count_summary_rna$hour00_rep1), log2(count_summary_rna$hour00_rep2))
hist(count_summary_rna$hour00_rep1)
hist(log2(count_summary_rna$hour00_rep1))
data_sub <- data %>% filter(hour14_rep1 > 2000)
View(data_sub)
names(data)
data <- data[, c(1:5, 9:14, 6:8)]
names(data)
data_sub <- data %>% filter(hour14_rep1 > 2000)
View(data_sub)
data_sum <- data %>% mutate(sum_hour00 = sum(hour00_rep1, hour00_rep2, hour00_rep3))
View(data_sum)
data_sum <- data %>% mutate(sum_hour00 = (hour00_rep1 + hour00_rep2 + hour00_rep3))
View(data_sum)
mart_export_coding <- read_csv("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/mart_export coding.txt")
mart_export_nonsense <- read_csv("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/mart_export nonsense.txt")
biomart <- rbind(mart_export_coding, mart_export_nonsense)
write_csv(biomart, "/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/ensembl_to_genesymbol")
library(readr)
ensembl_to_genesymbol <- read_csv("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/ensembl_to_genesymbol.csv")
View(ensembl_to_genesymbol)
head(ensembl_to_genesymbol$`Ensembl Transcript ID`)
head(data$Geneid)
x <- data %>% separate(Geneid, sep = ".", into = c("Geneid", "extra"))
View(x)
x <- data %>% separate(Geneid, sep = "\\.", into = c("Geneid", "extra"))
View(x)
View(x)
data <- data %>% separate(Geneid, sep = "\\.", into = c("Geneid", "extra"))
data$Geneid %>% unique() %>% nrow()
data$Geneid %>% unique() %>% n()
data$Geneid
data$Geneid %>% n()
data$Geneid %>% nrow()
norw(data$Geneid)
nrow(data$Geneid)
n(data$Geneid)
x <- data$Geneid
y <- unique(data$Geneid)
View(ensembl_to_genesymbol)
names(ensembl_to_genesymbol)
x <- left_join(data, ensembl_to_genesymbol, by.x = "Geneid", by.y = "Ensembl Transcript ID")
ensembl_to_genesymbol$`Ensembl Transcript ID`
x <- left_join(data, ensembl_to_genesymbol, by.x = Geneid, by.y = `Ensembl Transcript ID`)
names(ensembl_to_genesymbol)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(
`Ensembl Gene ID` = ensembl_gene,
`Ensembl Transcript ID` = ensembl_transcript,
`Transcript length (including UTRs and CDS)` = transcript_length,
`CDS Length` = cds_length,
`Associated Gene Name` = gene_symbol)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(
`Ensembl Gene ID` = "ensembl_gene",
`Ensembl Transcript ID` = "ensembl_transcript",
`Transcript length (including UTRs and CDS)` = "transcript_length",
`CDS Length` = "cds_length",
`Associated Gene Name` = "gene_symbol")
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(
`Ensembl Gene ID` = ensembl_gene,
`Ensembl Transcript ID` = ensembl_transcript,
`Transcript length (including UTRs and CDS)` = transcript_length,
`CDS Length` = cds_length,
`Associated Gene Name` = gene_symbol)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(
`Ensembl Gene ID` = `ensembl_gene`,
`Ensembl Transcript ID` = `ensembl_transcript`,
`Transcript length (including UTRs and CDS)` = `transcript_length`,
`CDS Length` = `cds_length`,
`Associated Gene Name` = `gene_symbol`)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Gene ID` = `ensembl_gene`, `Ensembl Transcript ID` = `ensembl_transcript`, `Transcript length (including UTRs and CDS)` = `transcript_length`, `CDS Length` = `cds_length`, `Associated Gene Name` = `gene_symbol`)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Gene ID` = ensembl_gene, `Ensembl Transcript ID` = `ensembl_transcript`, `Transcript length (including UTRs and CDS)` = `transcript_length`, `CDS Length` = `cds_length`, `Associated Gene Name` = `gene_symbol`)
View(ensembl_to_genesymbol)
names(ensembl_to_genesymbol)
x <- names(ensembl_to_genesymbol)
x
as.vector(x)
x
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Gene ID` = ensembl_gene)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Transcript ID` = `ensembl_transcript`)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Transcript ID` = ensembl_transcript)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(`Ensembl Transcript ID` = "ensembl_transcript")
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% rename(
ensembl_gene = `Ensembl Gene ID`,
ensembl_transcript = `Ensembl Transcript ID`,
transcript_length = `Transcript length (including UTRs and CDS)`,
cds_length = `CDS Length`,
gene_symbol = `Associated Gene Name`)
names(data)
data <- data %>% rename(
ensembl_transcript = Geneid)
x <- left_join(data, ensembl_to_genesymbol)
data_genelevel <- left_join(data, ensembl_to_genesymbol)
View(data_genelevel)
data_genelevel <- data_genelevel %>% select (-ensembl_transcript, -extra, -Length,  -ensembl_gene, -transcript_length, -cds_length)
names(data_genelevel)
data_genelevel <- data_genelevel %>% select (gene_symbol, everything())
names(data_genelevel)
nrow(data_genelevel)
data_genelevel <- data_genelevel %>%
group_by(gene_symbol) %>%
summarise(hour00_rep1 = sum(hour00_rep1),
hour00_rep2 = sum(hour00_rep2),
hour00_rep3 = sum(hour00_rep3),
hour04_rep1 = sum(hour04_rep1),
hour04_rep2 = sum(hour04_rep2),
hour04_rep3 = sum(hour04_rep3),
hour08_rep1 = sum(hour08_rep1),
hour08_rep2 = sum(hour08_rep2),
hour08_rep3 = sum(hour08_rep3),
hour14_rep1 = sum(hour14_rep1),
hour14_rep2 = sum(hour14_rep2),
hour14_rep3 = sum(hour14_rep3))
nrow(data_genelevel)
View(data_genelevel)
ensembl_to_genesymbol <- ensembl_to_genesymbol %>% select(ensembl_transcript, gene_symbol)
names(data)
data <- data %>% rename(
ensembl_transcript = Geneid)
data_genelevel <- left_join(data, ensembl_to_genesymbol)
names(data_genelevel)
x <- data_genelevel$ensembl_transcript
nrow(x)
y <- data_genelevel$gene_symbol
y <- unique(data_genelevel$gene_symbol)
x <- unique(data_genelevel$ensembl_transcript)
table(is.na(data_genelevel$gene_symbol))
n(unique(data_genelevel$gene_symbol))
unique(data_genelevel$gene_symbol) %>% count
unique(data_genelevel$gene_symbol) %>% n()
length(unique(data_genelevel$gene_symbol))
length(unique(data_genelevel$ensembl_transcript))
names(data_genelevel)
data_genelevel <- data_genelevel %>% select (-extra, -Length)
data_genelevel <- data_genelevel %>% select (gene_symbol, ensembl_transcript, everything())
names(data_genelevel)
length(unique(data_genelevel$ensembl_transcript))
length(unique(data_genelevel$gene_symbol))
nrow(data_genelevel)
data_genelevel <- data_genelevel %>%
group_by(ensembl_transcript) %>%
summarise(hour00_rep1 = sum(hour00_rep1),
hour00_rep2 = sum(hour00_rep2),
hour00_rep3 = sum(hour00_rep3),
hour04_rep1 = sum(hour04_rep1),
hour04_rep2 = sum(hour04_rep2),
hour04_rep3 = sum(hour04_rep3),
hour08_rep1 = sum(hour08_rep1),
hour08_rep2 = sum(hour08_rep2),
hour08_rep3 = sum(hour08_rep3),
hour14_rep1 = sum(hour14_rep1),
hour14_rep2 = sum(hour14_rep2),
hour14_rep3 = sum(hour14_rep3))
nrow(data_genelevel)
View(data_genelevel)
data_genelevel <- left_join(data, ensembl_to_genesymbol)
data_genelevel <- data_genelevel %>% select (-extra, -Length)
data_genelevel <- data_genelevel %>% select (gene_symbol, ensembl_transcript, everything())
nrow(data_genelevel)
data_genelevel <- data_genelevel %>%
group_by(ensembl_transcript) %>%
summarise(gene_symbol = gene_symbol,
hour00_rep1 = sum(hour00_rep1),
hour00_rep2 = sum(hour00_rep2),
hour00_rep3 = sum(hour00_rep3),
hour04_rep1 = sum(hour04_rep1),
hour04_rep2 = sum(hour04_rep2),
hour04_rep3 = sum(hour04_rep3),
hour08_rep1 = sum(hour08_rep1),
hour08_rep2 = sum(hour08_rep2),
hour08_rep3 = sum(hour08_rep3),
hour14_rep1 = sum(hour14_rep1),
hour14_rep2 = sum(hour14_rep2),
hour14_rep3 = sum(hour14_rep3))
data_genelevel <- data_genelevel %>% select (-extra, -Length, -ensembl_transcript)
data_genelevel <- left_join(data, ensembl_to_genesymbol)
data_genelevel <- data_genelevel %>% select (-extra, -Length, -ensembl_transcript)
data_genelevel <- data_genelevel %>% select (gene_symbol, everything())
length(data_genelevel$gene_symbol)
length(unique(data_genelevel$gene_symbol))
data_genelevel <- data_genelevel %>%
group_by(gene_symbol) %>%
summarise(hour00_rep1 = sum(hour00_rep1),
hour00_rep2 = sum(hour00_rep2),
hour00_rep3 = sum(hour00_rep3),
hour04_rep1 = sum(hour04_rep1),
hour04_rep2 = sum(hour04_rep2),
hour04_rep3 = sum(hour04_rep3),
hour08_rep1 = sum(hour08_rep1),
hour08_rep2 = sum(hour08_rep2),
hour08_rep3 = sum(hour08_rep3),
hour14_rep1 = sum(hour14_rep1),
hour14_rep2 = sum(hour14_rep2),
hour14_rep3 = sum(hour14_rep3))
nrow(data_genelevel)
