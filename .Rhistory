count_summary_rna <- read_delim("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/2018_MOLB7910/1-class1/data/count_summary_rna.tsv",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
library("tidyverse")
count_summary_rna <- read_delim("/Users/sjaganna/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/2018_MOLB7910/1-class1/data/count_summary_rna.tsv",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE,
skip = 1)
names(count_summary_rna)
library(readr)
experiment_metadata <- read_delim("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/experiment-metadata.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(experiment_metadata)
head(count_summary_rna)
tail(count_summary_rna)
summary(count_summary_rna)
summary(count_summary_rna$Geneid)
summary(count_summary_rna$`0h_1_RNA_S13_umi.bam`)
glimpse(count_summary_rna)
str(count_summary_rna)
table(count_summary_rna$`0h_1_RNA_S13_umi.bam`)
table(count_summary_rna$Chr)
table(count_summary_rna$Length)
table(experiment_metadata$hour)
glimpse(experiment_metadata)
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("skimr")
library("here")
x <- c(1,3,2,10,5)
x
x <- c(1,3,2,10,5)
x
x <- c(TRUE, FALSE, TRUE)
x <- c("sds","sd","as")
x
x <- as.Date(c("2019-02-25", "2019-02-27"))
x <- c(1,2,3,4)
y <- c(4,5,6,7)
m1 <- cbind(x,y)
m1
m2 <- rbind(x, y)
m2
m2 <- matrix(c(1,3,2,5,-1,2,2,3,9),nrow=3)
m2
m2[2, 2]
m2(2,)
m2[2,]
chr <- c("chr1", "chr1", "chr2", "chr2")
strand <- c("-", "-", "+", "+")
start <- c(200,4000,100,400)
end <-c(250,410,200,450)
mydata <- data.frame(chr, start, end, strand)
mydata
names(mydata)
mydata <- data.frame(CHROM=chr,
START=start,
STOP=end,
STRAND=strand)
mydata
mydata[,2]
class(mydata$START)
classmydata[,2]
class(mydata[,2])
class(mydata[,4])
w <- list(name="Fred",
mynumbers=c(1,2,3),
mymatrix=matrix(1:4,ncol=2),
age=5.3)
w
w[[3]]
class(w)
class(w$name)
class(w$mymatrix)
typeof(w)
typeof(w$mynumbers)
str(w)
mydata <- data.frame(CHROM=chr,
START=start,
STOP=end,
STRAND=strand)
class(mydata)
typeof(mydata)
str(mydata)
library(readr)
count_summary_rna <- read_delim("Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/input/count_summary_rna.tsv",
"\t", escape_double = FALSE, trim_ws = TRUE,
skip = 1)
View(count_summary_rna)
library(readr)
experiment_metadata <- read_delim("Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/input/experiment-metadata.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(experiment_metadata)
library(readr)
id_mapping <- read_csv("Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/input/id-mapping.csv")
View(id_mapping)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
experiment_metadata <- read_delim("Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910/1-class1/data/input/experiment-metadata.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(experiment_metadata)
head(count_summary_rna)
head(count_summary_rna)
dim(count_summary_rna)
str(count_summary_rna)
summary(count_summary_rna)
table(experiment_metadata)
table(experiment_metadata$hour)
skim(count_summary_rna)
library("skimr")
skim(count_summary_rna)
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`0h_2_RNA_S14_umi.bam`)
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`0h_2_RNA_S14_umi.bam`, log = "xy")
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`4h_2_RNA_S14_umi.bam`, log = "xy")
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`14h_1_RNA_S22_umi.bam`, log = "xy")
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`4h_2_RNA_S14_umi.bam`, log = "xy")
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`0h_2_RNA_S14_umi.bam`, log = "xy")
plot(x = count_summary_rna$`0h_1_RNA_S13_umi.bam`, y = count_summary_rna$`14h_1_RNA_S22_umi.bam`, log = "xy")
hist(x = log10(count_summary_rna$`0h_1_RNA_S13_umi.bam`))
data <- count_summary_rna %>%
select(-Chr, -Start, -End, -Strand)
library("tidyverse")
data <- count_summary_rna %>%
select(-Chr, -Start, -End, -Strand)
data <- data %>% rename(hour00_rep1 = `0h_1_RNA_S13_umi.bam`,
hour00_rep2 = `0h_2_RNA_S14_umi.bam`,
hour00_rep3 = `0h_3_RNA_S15_umi.bam`,
hour04_rep1 = `4h_1_RNA_S16_umi.bam`,
hour04_rep2 = `4h_2_RNA_S17_umi.bam`,
hour04_rep3 = `4h_3_RNA_S18_umi.bam`,
hour08_rep1 = `8h_1_RNA_S19_umi.bam`,
hour08_rep2 = `8h_2_RNA_S20_umi.bam`,
hour08_rep3 = `8h_3_RNA_S21_umi.bam`,
hour14_rep1 = `14h_1_RNA_S22_umi.bam`,
hour14_rep2 = `14h_2_RNA_S23_umi.bam`,
hour14_rep3 = `14h_3_RNA_S24_umi.bam`)
names(data)
data <- data[, c(1:5, 9:14, 6:8)]
data <- data[, c(1:5, 9:14, 6:8)]
data <- count_summary_rna %>%
select(-Chr, -Start, -End, -Strand)
data <- data %>% rename(hour00_rep1 = `0h_1_RNA_S13_umi.bam`,
hour00_rep2 = `0h_2_RNA_S14_umi.bam`,
hour00_rep3 = `0h_3_RNA_S15_umi.bam`,
hour04_rep1 = `4h_1_RNA_S16_umi.bam`,
hour04_rep2 = `4h_2_RNA_S17_umi.bam`,
hour04_rep3 = `4h_3_RNA_S18_umi.bam`,
hour08_rep1 = `8h_1_RNA_S19_umi.bam`,
hour08_rep2 = `8h_2_RNA_S20_umi.bam`,
hour08_rep3 = `8h_3_RNA_S21_umi.bam`,
hour14_rep1 = `14h_1_RNA_S22_umi.bam`,
hour14_rep2 = `14h_2_RNA_S23_umi.bam`,
hour14_rep3 = `14h_3_RNA_S24_umi.bam`)
data <- data[, c(1:5, 9:14, 6:8)]
names(data)
head(data$Geneid)
head(tx2geneid$ensembl_transcript_id)
head(id_mapping$ensembl_transcript_id)
data <- data %>% separate(Geneid, sep = "\\.", into = c("Geneid", "extra"))
View(data)
head(data)
data$Geneid
head(data$Geneid)
names(id_mapping)
tx2geneid <- tx2geneid[, c(2:4)]
id_mapping <- id_mapping[, c(2:4)]
data <- data %>% rename(
ensembl_transcript_id = Geneid)
data_transcriptlevel <- left_join(data, tx2geneid)
data_transcriptlevel <- left_join(data, id_mapping)
names(data_transcriptlevel)
setwd("~/Desktop/CU-onedrive/OneDrive - The University of Colorado Denver/08-teaching/molb7910")
